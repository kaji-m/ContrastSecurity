# PHPエージェントでDrupal（9.4.8）アプリをオンボード

## 前準備
contrast_security.yaml をDLして、ダミーのcontrast_security.ymlと入れ替えるか、ダミーファイルに正しい認証情報を設定します。  
エージェントに対する追加の設定（アプリ名、サーバ名など）があれば追加しておいてください。  
**（注意）**  
エージェントのログ出力先をデフォルトのままとすると、エージェントの起動に失敗します。  
以下のエージェントログの設定を追加してください。  
```yaml
agent:
  logger:
    path: /var/log/apache2/contrast-agent.log
```

## Dockerビルド
注意点として、contrast_security.yamlの内容に問題がある場合、Dockerビルドの際にAbortしたりします。  
その場合は、一番シンプルな構成のcontrast_security.yamlに戻してから試してみてください。
```bash
docker-compose build --no-cache
```

## 起動
```bash
docker-compose up -d
```

## アクセス
http://localhost:8080/  
にアクセスして、サンプルアプリにアクセスします。  
いくつか初期設定が必要になるので、以下のように設定してください。  
- 言語  
  日本語（任意）
- プロファイル  
  標準（任意）
- データベースの構成  
  - データベースのタイプ  
    MySQL
  - データベース名  
    drupal
  - データベースのユーザー名  
    root
  - データベースのパスワード  
    password
  - 高度なオプション  
    - ホスト  
      mysql
    - ポート番号  
      3306

```
Drupal はすでにインストールされています
```
と出た場合は「アップデートスクリプト」のリンクを叩いてください。  
あとは以下のリンクが出てくるので、適当に画面遷移してください。  
- フロントページ
- 管理画面のページ

## Contrastサーバでオンボード確認
サーバ、アプリのオンボードと脆弱性、ライブラリ情報、ルートカバレッジまで確認できます。
